{"ast":null,"code":"import _objectSpread from \"/home/lambamansha/Desktop/faculty_portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/home/lambamansha/Desktop/faculty_portal/src/views/Quiz/components/EditQuiz/components/QuestionsForm/index.jsx\";\nimport React, { Component } from \"react\";\nimport ContentForm from \"./Form\";\nimport validate from \"validate.js\";\nimport { addQuestion } from \"api/quizzes\";\nimport { connect } from \"react-redux\";\nimport swal from \"sweetalert\";\n\nclass QuestionsForm extends Component {\n  constructor(_props) {\n    super(_props);\n\n    this.getInitialState = props => {\n      if (props.mode === \"EDIT\") {\n        return {\n          data: _objectSpread({\n            questiontitle: \"\",\n            options: [\"\", \"\"],\n            correctOption: null,\n            difficultyLevel: \"\",\n            skills: []\n          }, props.data),\n          errors: {}\n        };\n      } else {\n        // default mode is assumed to be ADD\n        return {\n          data: {\n            questiontitle: \"\",\n            options: [\"\", \"\"],\n            correctOption: null,\n            difficultyLevel: \"\",\n            skills: []\n          },\n          errors: {}\n        };\n      }\n    };\n\n    this.onChangeHandler = e => {\n      const _e$target = e.target,\n            name = _e$target.name,\n            value = _e$target.value;\n      this.setState(prevState => {\n        return {\n          data: _objectSpread({}, prevState.data, {\n            [name]: value\n          }),\n          errors: _objectSpread({}, prevState.errors, {\n            [name]: null\n          })\n        };\n      });\n    };\n\n    this.onaddOption = () => {\n      this.setState(prevState => {\n        return {\n          data: _objectSpread({}, prevState.data, {\n            options: [...prevState.data.options, \"\"]\n          })\n        };\n      });\n    };\n\n    this.ondeleteOption = (e, index) => {\n      if (this.state.data.options.length > 2) {\n        let options = this.state.data.options;\n        options.splice(index, 1);\n        this.setState(prevState => {\n          return {\n            data: _objectSpread({}, prevState.data, {\n              options: [...options]\n            })\n          };\n        });\n      }\n    };\n\n    this.onOptionChange = (e, index) => {\n      console.log(\"hey\");\n      let options = this.state.data.options;\n      options[index] = e.target.value;\n      console.log(options);\n\n      if (this.state.errors.options) {\n        let optionsErr = this.state.errors.options;\n        optionsErr[index] = null;\n        this.setState(prevState => {\n          return {\n            errors: _objectSpread({}, prevState.errors, {\n              options: [...optionsErr]\n            })\n          };\n        });\n      }\n\n      this.setState(prevState => {\n        return {\n          data: _objectSpread({}, prevState.data, {\n            options: [...options]\n          })\n        };\n      });\n    };\n\n    this.skillChange = (e, skill) => {\n      console.log(skill);\n      this.setState(prevState => {\n        return {\n          errors: _objectSpread({}, prevState.errors, {\n            skills: null\n          })\n        };\n      });\n\n      if (!this.state.data.skills.includes(skill)) {\n        let skills = this.state.data.skills;\n        skills.push(skill);\n        this.setState(prevState => {\n          return {\n            data: _objectSpread({}, prevState.data, {\n              skills: [...skills]\n            })\n          };\n        });\n      } else {\n        let skills = this.state.data.skills;\n        let index = skills.indexOf(skill);\n        console.log(\"am there but pick me out\" + index);\n        skills.splice(index, 1);\n        console.log(skills);\n        this.setState(prevState => {\n          return {\n            data: _objectSpread({}, prevState.data, {\n              skills: [...skills]\n            })\n          };\n        });\n      }\n    };\n\n    this.OnCorrectOptionChange = (e, index) => {\n      this.setState(prevState => {\n        return {\n          errors: _objectSpread({}, prevState.errors, {\n            correctOption: null\n          })\n        };\n      });\n      let correctoption = this.state.data.options[index];\n\n      if (this.state.data.options[index] != this.state.data.correctOption) {\n        this.setState(prevState => {\n          return {\n            data: _objectSpread({}, prevState.data, {\n              correctOption: correctoption\n            })\n          };\n        });\n      } else {\n        this.setState(prevState => {\n          return {\n            data: _objectSpread({}, prevState.data, {\n              correctOption: \"\"\n            })\n          };\n        });\n      }\n    };\n\n    this.onSubmitHandler = () => {\n      console.log(\"submission handler\"); //validation\n\n      let errors = validate(this.state.data, {\n        questiontitle: {\n          presence: {\n            allowEmpty: false,\n            message: \"is required\"\n          }\n        },\n        difficultyLevel: {\n          presence: {\n            allowEmpty: false,\n            message: \"is required\"\n          }\n        },\n        skills: {\n          presence: {\n            allowEmpty: false,\n            message: \"is required\"\n          }\n        },\n        correctOption: {\n          presence: {\n            allowEmpty: false,\n            message: \"is required\"\n          }\n        }\n      });\n      let optionsErr = this.state.data.options.map(option => {\n        let error = {};\n\n        if (option === \"\") {\n          error.Option = \"*required\";\n        }\n\n        return Object.keys(error).length > 0 ? error : null;\n      }); // check for errors\n\n      if (optionsErr.some(val => val !== null) && errors) {\n        this.setState(prevState => {\n          return {\n            data: _objectSpread({}, prevState.data),\n            errors: _objectSpread({}, prevState.errors, errors, {\n              options: optionsErr\n            })\n          };\n        });\n      } else if (errors) {\n        this.setState({\n          errors\n        });\n      } else if (optionsErr.some(val => val !== null)) {\n        this.setState(prevState => {\n          return {\n            data: _objectSpread({}, prevState.data),\n            errors: _objectSpread({}, prevState.errors, {\n              options: optionsErr\n            })\n          };\n        });\n      } else {\n        this.addQuestion();\n      }\n\n      console.log(errors);\n    };\n\n    this.addQuestion = () => {\n      let data = {\n        question: this.state.data.questiontitle,\n        skills: this.state.data.skills,\n        level: this.state.data.difficultyLevel,\n        options: this.state.data.options.map(option => {\n          return {\n            value: option,\n            isCorrect: option == this.state.data.correctOption\n          };\n        })\n      };\n      addQuestion(this.props.token, data, this.props.quizId).then(data => {\n        console.log(data);\n        swal({\n          title: \"Question has been sent successfully\",\n          button: \"Ok\"\n        });\n        this.props.AddQuestionToTable(data.question);\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.state = this.getInitialState(_props);\n  }\n\n  render() {\n    return React.createElement(ContentForm, {\n      open: this.props.open,\n      onChangeHandler: this.onChangeHandler,\n      onSubmit: this.onSubmitHandler,\n      errors: this.state.errors,\n      data: this.state.data,\n      years: this.years,\n      types: this.types,\n      handleCloseForm: this.props.handleCloseForm,\n      mode: this.props.mode,\n      skills: this.props.skills,\n      onaddOption: this.onaddOption,\n      ondeleteOption: this.ondeleteOption,\n      onSkillChange: this.skillChange,\n      skillChange: this.skillChange,\n      onOptionChange: this.onOptionChange,\n      OnCorrectOptionChange: this.OnCorrectOptionChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    });\n  }\n\n}\n\nQuestionsForm.defaultProps = {\n  mode: \"ADD\"\n};\n\nconst mapStateToProps = state => {\n  return {\n    token: state.auth.token\n  };\n};\n\nexport default connect(mapStateToProps)(QuestionsForm);","map":{"version":3,"sources":["/home/lambamansha/Desktop/faculty_portal/src/views/Quiz/components/EditQuiz/components/QuestionsForm/index.jsx"],"names":["React","Component","ContentForm","validate","addQuestion","connect","swal","QuestionsForm","constructor","props","getInitialState","mode","data","questiontitle","options","correctOption","difficultyLevel","skills","errors","onChangeHandler","e","target","name","value","setState","prevState","onaddOption","ondeleteOption","index","state","length","splice","onOptionChange","console","log","optionsErr","skillChange","skill","includes","push","indexOf","OnCorrectOptionChange","correctoption","onSubmitHandler","presence","allowEmpty","message","map","option","error","Option","Object","keys","some","val","question","level","isCorrect","token","quizId","then","title","button","AddQuestionToTable","catch","render","open","years","types","handleCloseForm","defaultProps","mapStateToProps","auth"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport ContentForm from \"./Form\";\nimport validate from \"validate.js\";\nimport { addQuestion } from \"api/quizzes\";\nimport { connect } from \"react-redux\";\nimport swal from \"sweetalert\";\n\nclass QuestionsForm extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = this.getInitialState(props);\n\t}\n\n\tstatic defaultProps = {\n\t\tmode: \"ADD\"\n\t};\n\n\tgetInitialState = props => {\n\t\tif (props.mode === \"EDIT\") {\n\t\t\treturn {\n\t\t\t\tdata: {\n\t\t\t\t\tquestiontitle: \"\",\n\t\t\t\t\toptions: [\"\", \"\"],\n\t\t\t\t\tcorrectOption: null,\n\t\t\t\t\tdifficultyLevel: \"\",\n\t\t\t\t\tskills: [],\n\t\t\t\t\t...props.data\n\t\t\t\t},\n\t\t\t\terrors: {}\n\t\t\t};\n\t\t} else {\n\t\t\t// default mode is assumed to be ADD\n\t\t\treturn {\n\t\t\t\tdata: {\n\t\t\t\t\tquestiontitle: \"\",\n\t\t\t\t\toptions: [\"\", \"\"],\n\t\t\t\t\tcorrectOption: null,\n\t\t\t\t\tdifficultyLevel: \"\",\n\t\t\t\t\tskills: []\n\t\t\t\t},\n\t\t\t\terrors: {}\n\t\t\t};\n\t\t}\n\t};\n\n\tonChangeHandler = e => {\n\t\tconst { name, value } = e.target;\n\n\t\tthis.setState(prevState => {\n\t\t\treturn {\n\t\t\t\tdata: {\n\t\t\t\t\t...prevState.data,\n\t\t\t\t\t[name]: value\n\t\t\t\t},\n\t\t\t\terrors: {\n\t\t\t\t\t...prevState.errors,\n\t\t\t\t\t[name]: null\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t};\n\n\tonaddOption = () => {\n\t\tthis.setState(prevState => {\n\t\t\treturn {\n\t\t\t\tdata: {\n\t\t\t\t\t...prevState.data,\n\t\t\t\t\toptions: [...prevState.data.options, \"\"]\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t};\n\tondeleteOption = (e, index) => {\n\t\tif (this.state.data.options.length > 2) {\n\t\t\tlet options = this.state.data.options;\n\t\t\toptions.splice(index, 1);\n\t\t\tthis.setState(prevState => {\n\t\t\t\treturn {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...prevState.data,\n\n\t\t\t\t\t\toptions: [...options]\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t};\n\tonOptionChange = (e, index) => {\n\t\tconsole.log(\"hey\");\n\t\tlet options = this.state.data.options;\n\t\toptions[index] = e.target.value;\n\t\tconsole.log(options);\n\n\t\tif (this.state.errors.options) {\n\t\t\tlet optionsErr = this.state.errors.options;\n\t\t\toptionsErr[index] = null;\n\t\t\tthis.setState(prevState => {\n\t\t\t\treturn {\n\t\t\t\t\terrors: {\n\t\t\t\t\t\t...prevState.errors,\n\t\t\t\t\t\toptions: [...optionsErr]\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t\tthis.setState(prevState => {\n\t\t\treturn {\n\t\t\t\tdata: {\n\t\t\t\t\t...prevState.data,\n\t\t\t\t\toptions: [...options]\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t};\n\n\tskillChange = (e, skill) => {\n\t\tconsole.log(skill);\n\t\tthis.setState(prevState => {\n\t\t\treturn {\n\t\t\t\terrors: {\n\t\t\t\t\t...prevState.errors,\n\t\t\t\t\tskills: null\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\n\t\tif (!this.state.data.skills.includes(skill)) {\n\t\t\tlet skills = this.state.data.skills;\n\t\t\tskills.push(skill);\n\t\t\tthis.setState(prevState => {\n\t\t\t\treturn {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...prevState.data,\n\t\t\t\t\t\tskills: [...skills]\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t});\n\t\t} else {\n\t\t\tlet skills = this.state.data.skills;\n\n\t\t\tlet index = skills.indexOf(skill);\n\t\t\tconsole.log(\"am there but pick me out\" + index);\n\t\t\tskills.splice(index, 1);\n\t\t\tconsole.log(skills);\n\t\t\tthis.setState(prevState => {\n\t\t\t\treturn {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...prevState.data,\n\t\t\t\t\t\tskills: [...skills]\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t};\n\n\tOnCorrectOptionChange = (e, index) => {\n\t\tthis.setState(prevState => {\n\t\t\treturn {\n\t\t\t\terrors: {\n\t\t\t\t\t...prevState.errors,\n\t\t\t\t\tcorrectOption: null\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t\tlet correctoption = this.state.data.options[index];\n\t\tif (this.state.data.options[index] != this.state.data.correctOption) {\n\t\t\tthis.setState(prevState => {\n\t\t\t\treturn {\n\t\t\t\t\tdata: { ...prevState.data, correctOption: correctoption }\n\t\t\t\t};\n\t\t\t});\n\t\t} else {\n\t\t\tthis.setState(prevState => {\n\t\t\t\treturn {\n\t\t\t\t\tdata: { ...prevState.data, correctOption: \"\" }\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t};\n\n\tonSubmitHandler = () => {\n\t\tconsole.log(\"submission handler\");\n\t\t//validation\n\t\tlet errors = validate(this.state.data, {\n\t\t\tquestiontitle: {\n\t\t\t\tpresence: { allowEmpty: false, message: \"is required\" }\n\t\t\t},\n\t\t\tdifficultyLevel: {\n\t\t\t\tpresence: { allowEmpty: false, message: \"is required\" }\n\t\t\t},\n\t\t\tskills: {\n\t\t\t\tpresence: { allowEmpty: false, message: \"is required\" }\n\t\t\t},\n\t\t\tcorrectOption: {\n\t\t\t\tpresence: { allowEmpty: false, message: \"is required\" }\n\t\t\t}\n\t\t});\n\n\t\tlet optionsErr = this.state.data.options.map(option => {\n\t\t\tlet error = {};\n\n\t\t\tif (option === \"\") {\n\t\t\t\terror.Option = \"*required\";\n\t\t\t}\n\n\t\t\treturn Object.keys(error).length > 0 ? error : null;\n\t\t});\n\n\t\t// check for errors\n\t\tif (optionsErr.some(val => val !== null) && errors) {\n\t\t\tthis.setState(prevState => {\n\t\t\t\treturn {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...prevState.data\n\t\t\t\t\t},\n\n\t\t\t\t\terrors: {\n\t\t\t\t\t\t...prevState.errors,\n\t\t\t\t\t\t...errors,\n\t\t\t\t\t\toptions: optionsErr\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t});\n\t\t} else if (errors) {\n\t\t\tthis.setState({ errors });\n\t\t} else if (optionsErr.some(val => val !== null)) {\n\t\t\tthis.setState(prevState => {\n\t\t\t\treturn {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...prevState.data\n\t\t\t\t\t},\n\n\t\t\t\t\terrors: {\n\t\t\t\t\t\t...prevState.errors,\n\n\t\t\t\t\t\toptions: optionsErr\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t});\n\t\t} else {\n\t\t\tthis.addQuestion();\n\t\t}\n\n\t\tconsole.log(errors);\n\t};\n\n\taddQuestion = () => {\n\t\tlet data = {\n\t\t\tquestion: this.state.data.questiontitle,\n\t\t\tskills: this.state.data.skills,\n\t\t\tlevel: this.state.data.difficultyLevel,\n\t\t\toptions: this.state.data.options.map(option => {\n\t\t\t\treturn {\n\t\t\t\t\tvalue: option,\n\t\t\t\t\tisCorrect: option == this.state.data.correctOption\n\t\t\t\t};\n\t\t\t})\n\t\t};\n\n\t\taddQuestion(this.props.token, data, this.props.quizId)\n\t\t\t.then(data => {\n\t\t\t\tconsole.log(data);\n\t\t\t\tswal({\n\t\t\t\t\ttitle: \"Question has been sent successfully\",\n\n\t\t\t\t\tbutton: \"Ok\"\n\t\t\t\t});\n\n\t\t\t\tthis.props.AddQuestionToTable(data.question);\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tconsole.log(error);\n\t\t\t});\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<ContentForm\n\t\t\t\topen={this.props.open}\n\t\t\t\tonChangeHandler={this.onChangeHandler}\n\t\t\t\tonSubmit={this.onSubmitHandler}\n\t\t\t\terrors={this.state.errors}\n\t\t\t\tdata={this.state.data}\n\t\t\t\tyears={this.years}\n\t\t\t\ttypes={this.types}\n\t\t\t\thandleCloseForm={this.props.handleCloseForm}\n\t\t\t\tmode={this.props.mode}\n\t\t\t\tskills={this.props.skills}\n\t\t\t\tonaddOption={this.onaddOption}\n\t\t\t\tondeleteOption={this.ondeleteOption}\n\t\t\t\tonSkillChange={this.skillChange}\n\t\t\t\tskillChange={this.skillChange}\n\t\t\t\tonOptionChange={this.onOptionChange}\n\t\t\t\tOnCorrectOptionChange={this.OnCorrectOptionChange}\n\t\t\t/>\n\t\t);\n\t}\n}\nconst mapStateToProps = state => {\n\treturn {\n\t\ttoken: state.auth.token\n\t};\n};\n\nexport default connect(mapStateToProps)(QuestionsForm);\n"]},"metadata":{},"sourceType":"module"}